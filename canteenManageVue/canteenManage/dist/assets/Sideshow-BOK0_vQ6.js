/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as p}from"./request-D4_zAD7W.js";import{r as T,s as j,c as b,a as c,b as o,w as a,v as A,E as i,x as y,y as M,z as O,A as R,B as G,C as H,o as h,g as m,u as f,D as K,F as L,G as Q,H as W,k as X,I as Y,J as Z,K as ee,L as te}from"./index-CnZojLtj.js";const oe={class:"card"},le={class:"card",style:{"margin-bottom":"10px"}},ae={class:"card",style:{"margin-bottom":"10px"}},se={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},ie={key:0,class:"card"},ne={class:"dialog-footer"},ke={__name:"Sideshow",setup(re){const w="http://localhost:9090",t=T({formVisible:!1,form:{name:"",img:""},tableData:[],pageNum:1,pageSize:10,total:0,name:null,ids:[],rules:{name:[{required:!0,message:"请输入轮播图名称",trigger:"blur"}],img:[{required:!0,message:"请传入轮播图图片",trigger:"blur"}]}}),g=j(),v=()=>{t.form={},t.formVisible=!0},V=()=>{p.post("/sideshow/add",t.form).then(l=>{l.code==="200"?(i.success("添加成功"),d(),t.formVisible=!1):i.error(l.msg)})},x=l=>{t.form=JSON.parse(JSON.stringify(l)),t.formVisible=!0},C=l=>{t.ids=l.map(e=>e.id)},d=()=>{p.get("/sideshow/selectPage",{params:{pageNum:t.pageNum,pageSize:t.pageSize,name:t.name}}).then(l=>{var e,n;l.code==="200"?(t.tableData=((e=l.data)==null?void 0:e.list)||[],t.total=(n=l.data)==null?void 0:n.total):i.error(l.msg)})};d();const k=()=>{p.put("/sideshow/update",t.form).then(l=>{l.code==="200"?(i.success("更新成功"),d(),t.formVisible=!1):i.error(l.msg)})},E=l=>{y.confirm("是否删除该轮播图信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(e=>{p.delete(`/sideshow/delete/${l.id}`).then(n=>{n.code==="200"?(i.success("删除成功"),d()):i.error(n.msg)}).catch(n=>{i.error(n)})})},N=()=>{if(!t.ids.length){i.warning("请选择要删除的轮播图信息");return}y.confirm("是否删除该轮播图信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(l=>{p.delete("/sideshow/delete/batch",{data:t.ids}).then(e=>{e.code==="200"?(i.success("删除成功"),d()):i.error(e.msg)}).catch(e=>{i.error(e)})})},S=()=>{g.value.validate(l=>{l&&(t.form.id?k():V())})},z=l=>{t.form.img=l.data,i.success("文件上传成功，点击“确定”即可查看")},B=()=>{t.name=null,d()};return(l,e)=>{const n=M,r=O,u=W,I=X,U=Y,D=R,$=G,_=Z,q=ee,F=te,J=H;return h(),b("div",null,[c("div",oe,[o(n,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=s=>t.name=s),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入轮播图名称"},null,8,["modelValue"]),o(r,{type:"info",plain:"",onClick:d},{default:a(()=>e[5]||(e[5]=[m("查询")])),_:1}),o(r,{type:"info",style:{margin:"0 10px"},plain:"",onClick:B},{default:a(()=>e[6]||(e[6]=[m("重置")])),_:1})]),c("div",le,[o(r,{type:"primary",plain:"",onClick:v},{default:a(()=>e[7]||(e[7]=[m("新增")])),_:1}),o(r,{type:"danger",plain:"",onClick:N},{default:a(()=>e[8]||(e[8]=[m("批量删除")])),_:1})]),c("div",ae,[o(D,{stripe:"",data:t.tableData,border:"",style:{width:"100%"},onSelectionChange:C},{default:a(()=>[o(u,{type:"selection",width:"55","header-align":"center",align:"center"}),o(u,{prop:"name",label:"名称"}),o(u,{prop:"img",label:"图片"},{default:a(s=>[o(U,{src:s.row.img,"preview-src-list":[s.row.img],fit:"cover",style:{width:"50px",height:"50px","object-fit":"cover"},"preview-teleported":""},{error:a(()=>[c("div",se,[o(I,null,{default:a(()=>[o(f(K))]),_:1})])]),_:2},1032,["src","preview-src-list"])]),_:1}),o(u,{label:"操作",width:"180"},{default:a(s=>[o(r,{type:"primary",circle:"",icon:f(L),onClick:P=>x(s.row)},null,8,["icon","onClick"]),o(r,{type:"danger",circle:"",icon:f(Q),onClick:P=>E(s.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),t.total?(h(),b("div",ie,[o($,{onCurrentChange:d,background:"",layout:"total, prev, pager, next","page-size":t.pageSize,"current-page":t.pageNum,"onUpdate:currentPage":e[1]||(e[1]=s=>t.pageNum=s),total:t.total},null,8,["page-size","current-page","total"])])):A("",!0),o(J,{title:"轮播图",modelValue:t.formVisible,"onUpdate:modelValue":e[4]||(e[4]=s=>t.formVisible=s),width:"30%"},{footer:a(()=>[c("div",ne,[o(r,{onClick:e[3]||(e[3]=s=>t.formVisible=!1)},{default:a(()=>e[10]||(e[10]=[m("取消")])),_:1}),o(r,{type:"primary",onClick:S},{default:a(()=>e[11]||(e[11]=[m(" 确定 ")])),_:1})])]),default:a(()=>[o(F,{ref_key:"formRef",ref:g,rules:t.rules,model:t.form,"label-width":"80px",style:{padding:"20px"}},{default:a(()=>[o(_,{prop:"name",label:"名称"},{default:a(()=>[o(n,{modelValue:t.form.name,"onUpdate:modelValue":e[2]||(e[2]=s=>t.form.name=s),placeholder:"请输入轮播图名称"},null,8,["modelValue"])]),_:1}),o(_,{prop:"img",label:"图片"},{default:a(()=>[o(q,{class:"upload-demo",action:f(w)+"/files/upload","on-success":z,"list-type":"picture","show-file-list":!1},{default:a(()=>[o(r,{type:"primary"},{default:a(()=>e[9]||(e[9]=[m("文件上传")])),_:1})]),_:1},8,["action"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ke as default};
