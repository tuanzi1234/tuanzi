/* empty css                *//* empty css                  *//* empty css               *//* empty css              */import{r as _}from"./request-Deya0qTv.js";import{s as P,r as x,c as V,a as u,b as r,w as a,L as v,o as E,g as b,E as p,y,J as I,z as h}from"./index-BRfxGLPL.js";const B={style:{width:"40%",margin:"20px auto"},class:"card"},N={style:{"text-align":"center"}},F={__name:"Password",setup(q){const n=P(),m=(l,e,o)=>{e?(e!==s.user.newPassword&&o(new Error("两次输入的密码不匹配，请重新输入")),o()):o(new Error("请输入密码"))},i=JSON.parse(localStorage.getItem("project-user")||"{}"),s=x({user:{password:"",newPassword:"",confirmPassword:""},rules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{validator:m,trigger:"blur"}]}}),w=()=>{n.value.validate(l=>{if(l){const e={...i,password:s.user.password,newPassword:s.user.newPassword};_.put("/updatePassword",e).then(o=>{o.code==="200"?(p.success("更新成功"),setInterval(()=>{f()},500)):p.error(o.msg)})}else console.log("验证失败")})},f=()=>{localStorage.removeItem("project-user"),setInterval(()=>{location.href="/login"},500)};return(l,e)=>{const o=y,d=I,c=h,g=v;return E(),V("div",B,[e[4]||(e[4]=u("div",{class:"card-title",style:{margin:"10px 0 20px 15px","font-weight":"bold","font-size":"20px"}},"修改密码",-1)),r(g,{ref_key:"formRef",ref:n,rules:s.rules,model:s.user,"label-width":"70px",style:{padding:"20px"}},{default:a(()=>[r(d,{label:"原密码",prop:"password"},{default:a(()=>[r(o,{modelValue:s.user.password,"onUpdate:modelValue":e[0]||(e[0]=t=>s.user.password=t),placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),r(d,{label:"新密码",prop:"newPassword"},{default:a(()=>[r(o,{modelValue:s.user.newPassword,"onUpdate:modelValue":e[1]||(e[1]=t=>s.user.newPassword=t),placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(d,{label:"新密码",prop:"confirmPassword"},{default:a(()=>[r(o,{modelValue:s.user.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.user.confirmPassword=t),placeholder:"再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),u("div",N,[r(c,{type:"primary",onClick:w},{default:a(()=>e[3]||(e[3]=[b("保存")])),_:1})])]),_:1},8,["rules","model"])])}}};export{F as default};
