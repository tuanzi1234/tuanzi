/* empty css                *//* empty css                  *//* empty css               *//* empty css              */import{r as _}from"./request-DjFgx_mW.js";import{s as P,r as x,c as V,a as u,b as o,w as a,L as b,o as v,g as E,E as p,y,J as I,z as h}from"./index-5FTUK4ks.js";const B={style:{width:"40%",margin:"20px auto"},class:"card"},N={style:{"text-align":"center"}},F={__name:"Password",setup(q){const n=P(),m=(l,e,r)=>{e?(e!==s.user.newPassword&&r(new Error("两次输入的密码不匹配，请重新输入")),r()):r(new Error("请输入密码"))},i=JSON.parse(localStorage.getItem("project-user")||"{}"),s=x({user:{password:"",newPassword:"",confirmPassword:""},rules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"},{min:6,message:"密码不能少于六位",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码不能少于六位",trigger:"blur"}],confirmPassword:[{validator:m,trigger:"blur"}]}}),w=()=>{n.value.validate(l=>{if(l){const e={...i,password:s.user.password,newPassword:s.user.newPassword};_.put("/updatePassword",e).then(r=>{r.code==="200"?(p.success("更新成功"),setInterval(()=>{f()},500)):p.error(r.msg)})}else console.log("验证失败")})},f=()=>{localStorage.removeItem("project-user"),setInterval(()=>{location.href="/login"},500)};return(l,e)=>{const r=y,d=I,c=h,g=b;return v(),V("div",B,[e[4]||(e[4]=u("div",{class:"card-title",style:{margin:"10px 0 20px 15px","font-weight":"bold","font-size":"20px"}},"修改密码",-1)),o(g,{ref_key:"formRef",ref:n,rules:s.rules,model:s.user,"label-width":"70px",style:{padding:"20px"}},{default:a(()=>[o(d,{label:"原密码",prop:"password"},{default:a(()=>[o(r,{modelValue:s.user.password,"onUpdate:modelValue":e[0]||(e[0]=t=>s.user.password=t),placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码",prop:"newPassword"},{default:a(()=>[o(r,{modelValue:s.user.newPassword,"onUpdate:modelValue":e[1]||(e[1]=t=>s.user.newPassword=t),placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码",prop:"confirmPassword"},{default:a(()=>[o(r,{modelValue:s.user.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.user.confirmPassword=t),placeholder:"再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),u("div",N,[o(c,{type:"primary",onClick:w},{default:a(()=>e[3]||(e[3]=[E("保存")])),_:1})])]),_:1},8,["rules","model"])])}}};export{F as default};
