/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                *//* empty css               *//* empty css              */import{r as u}from"./request-NPF86asl.js";import{r as q,s as F,c as _,a as c,b as l,w as n,v as J,E as i,x as b,y as P,z as T,A,B as I,C as M,o as V,g as m,u as y,F as O,G as R,H as G,J as H,L}from"./index-DDdsWfNx.js";const j={class:"card"},K={class:"card",style:{"margin-bottom":"10px"}},Q={class:"card",style:{"margin-bottom":"10px"}},W={key:0,class:"card"},X={class:"dialog-footer"},ce={__name:"Notice",setup(Y){const e=q({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:5,total:0,title:null,content:null,ids:[],rules:{title:[{required:!0,message:"请输入公告标题",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"}]}}),f=F(),x=()=>{e.form={},e.formVisible=!0},C=()=>{u.post("/notice/add",e.form).then(o=>{o.code==="200"?(i.success("添加成功"),s(),e.formVisible=!1):i.error(o.msg)})},h=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0},k=o=>{e.ids=o.map(t=>t.id)},s=()=>{u.get("/notice/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,title:e.title,content:e.content}}).then(o=>{var t,r;o.code==="200"?(e.tableData=((t=o.data)==null?void 0:t.list)||[],e.total=(r=o.data)==null?void 0:r.total):i.error(o.msg)})};s();const v=()=>{u.put("/notice/update",e.form).then(o=>{o.code==="200"?(i.success("更新成功"),s(),e.formVisible=!1):i.error(o.msg)})},w=o=>{b.confirm("是否删除该系统公告信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(t=>{u.delete(`/notice/delete/${o.id}`).then(r=>{r.code==="200"?(i.success("删除成功"),s()):i.error(r.msg)}).catch(r=>{i.error(r)})})},E=()=>{if(!e.ids.length){i.warning("请选择要删除的系统公告信息");return}b.confirm("是否删除该系统公告信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(o=>{u.delete("/notice/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(i.success("删除成功"),s()):i.error(t.msg)}).catch(t=>{i.error(t)})})},N=()=>{f.value.validate(o=>{o&&(e.form.id?v():C())})},S=()=>{e.title=null,e.content=null,s()};return(o,t)=>{const r=P,d=T,p=G,z=A,B=I,g=H,U=L,D=M;return V(),_("div",null,[c("div",j,[l(r,{modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=a=>e.title=a),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入标题"},null,8,["modelValue"]),l(r,{modelValue:e.content,"onUpdate:modelValue":t[1]||(t[1]=a=>e.content=a),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入内容"},null,8,["modelValue"]),l(d,{type:"info",plain:"",onClick:s},{default:n(()=>t[7]||(t[7]=[m("查询")])),_:1}),l(d,{type:"info",style:{margin:"0 10px"},plain:"",onClick:S},{default:n(()=>t[8]||(t[8]=[m("重置")])),_:1})]),c("div",K,[l(d,{type:"primary",plain:"",onClick:x},{default:n(()=>t[9]||(t[9]=[m("新增")])),_:1}),l(d,{type:"danger",plain:"",onClick:E},{default:n(()=>t[10]||(t[10]=[m("批量删除")])),_:1})]),c("div",Q,[l(z,{stripe:"",data:e.tableData,border:"",style:{width:"100%"},onSelectionChange:k},{default:n(()=>[l(p,{type:"selection",width:"55","header-align":"center",align:"center"}),l(p,{prop:"title",label:"公告标题"}),l(p,{prop:"content",label:"公告内容"}),l(p,{prop:"time",label:"发布时间"}),l(p,{label:"操作",width:"180"},{default:n(a=>[l(d,{type:"primary",circle:"",icon:y(O),onClick:$=>h(a.row)},null,8,["icon","onClick"]),l(d,{type:"danger",circle:"",icon:y(R),onClick:$=>w(a.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(V(),_("div",W,[l(B,{onCurrentChange:s,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[2]||(t[2]=a=>e.pageNum=a),total:e.total},null,8,["page-size","current-page","total"])])):J("",!0),l(D,{title:"公告信息",modelValue:e.formVisible,"onUpdate:modelValue":t[6]||(t[6]=a=>e.formVisible=a),width:"30%"},{footer:n(()=>[c("div",X,[l(d,{onClick:t[5]||(t[5]=a=>e.formVisible=!1)},{default:n(()=>t[11]||(t[11]=[m("取消")])),_:1}),l(d,{type:"primary",onClick:N},{default:n(()=>t[12]||(t[12]=[m(" 确定 ")])),_:1})])]),default:n(()=>[l(U,{ref_key:"formRef",ref:f,rules:e.rules,model:e.form,"label-width":"80px",style:{padding:"20px"}},{default:n(()=>[l(g,{prop:"title",label:"公告标题"},{default:n(()=>[l(r,{modelValue:e.form.title,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.title=a),placeholder:"请输入公告标题"},null,8,["modelValue"])]),_:1}),l(g,{prop:"content",label:"公告内容"},{default:n(()=>[l(r,{type:"textarea",rows:"4",modelValue:e.form.content,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.content=a),placeholder:"请输入公告内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ce as default};
