/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as f}from"./request-DjFgx_mW.js";import{r as Q,s as W,c as y,a as g,b as l,w as a,v as h,E as n,x as C,M as X,y as Y,z as Z,A as ee,B as te,C as le,o as m,N as I,O as N,P as b,g as u,u as V,D as oe,t as w,F as ae,G as re,Q as ne,H as se,k as ie,I as de,R as ue,J as pe,K as me,S as ce,T as ge,L as fe}from"./index-5FTUK4ks.js";const _e={class:"card"},ye={class:"card",style:{"margin-bottom":"10px"}},be={class:"card",style:{"margin-bottom":"10px"}},Ve={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},we={style:{color:"red"}},he={style:{color:"#008B45"}},ve={key:0,class:"card"},ke={class:"dialog-footer"},Me={__name:"Dish",setup(xe){const S="http://localhost:9090",e=Q({categoryId:"",categoryData:[],formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:5,total:0,title:null,content:null,name:null,ids:[],rules:{name:[{required:!0,message:"请输入菜品名称",trigger:"blur"}],categoryId:[{required:!0,message:"请选择菜品分类",trigger:"blur"}],content:[{required:!0,message:"请输入菜品描述",trigger:"blur"}],price:[{required:!0,message:"请输入菜品价格",trigger:"blur"}],num:[{required:!0,message:"请输入菜品剩余份数",trigger:"blur"}],img:[{required:!0,message:"请上传菜品封面",trigger:"blur"}]}}),v=W();(()=>{f.get("/category/selectAll").then(r=>{r.code==="200"?e.categoryData=r.data:n.error(r.msg)})})();const U=()=>{e.form={},e.formVisible=!0},D=()=>{f.post("/dish/add",e.form).then(r=>{r.code==="200"?(n.success("添加成功"),p(),e.formVisible=!1):n.error(r.msg)})},B=r=>{e.form=JSON.parse(JSON.stringify(r)),e.formVisible=!0},q=r=>{e.ids=r.map(t=>t.id)},p=()=>{f.get("/dish/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,title:e.title,content:e.content,name:e.name,categoryId:e.categoryId}}).then(r=>{var t,s;r.code==="200"?(e.tableData=((t=r.data)==null?void 0:t.list)||[],e.total=(s=r.data)==null?void 0:s.total):n.error(r.msg)})};p();const z=()=>{f.put("/dish/update",e.form).then(r=>{r.code==="200"?(n.success("更新成功"),p(),e.formVisible=!1):n.error(r.msg)})},R=r=>{C.confirm("是否删除该菜品信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(t=>{f.delete(`/dish/delete/${r.id}`).then(s=>{s.code==="200"?(n.success("删除成功"),p()):n.error(s.msg)}).catch(s=>{n.error(s)})})},T=()=>{if(!e.ids.length){n.warning("请选择要删除的菜品信息");return}C.confirm("是否删除该菜品信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(r=>{f.delete("/dish/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(n.success("删除成功"),p()):n.error(t.msg)}).catch(t=>{n.error(t)})})},F=r=>{e.form.img=r.data,n.success("文件上传成功，点击“确定”即可查看")},O=()=>{v.value.validate(r=>{r&&(e.form.id?z():D())})},P=()=>{e.categoryId=null,e.name=null,p()};return(r,t)=>{const s=ne,k=X,_=Y,d=Z,i=se,$=ie,A=de,x=ue,J=ee,M=te,c=pe,j=me,E=ce,G=ge,L=fe,H=le;return m(),y("div",null,[g("div",_e,[l(k,{modelValue:e.categoryId,"onUpdate:modelValue":t[0]||(t[0]=o=>e.categoryId=o),placeholder:"请选择菜品分类",style:{width:"240px","padding-right":"10px"}},{default:a(()=>[(m(!0),y(I,null,N(e.categoryData,o=>(m(),b(s,{key:o.id,label:o.title,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(_,{modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.name=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入菜品名称"},null,8,["modelValue"]),l(d,{type:"info",plain:"",onClick:p},{default:a(()=>t[11]||(t[11]=[u("查询")])),_:1}),l(d,{type:"info",style:{margin:"0 10px"},plain:"",onClick:P},{default:a(()=>t[12]||(t[12]=[u("重置")])),_:1})]),g("div",ye,[l(d,{type:"primary",plain:"",onClick:U},{default:a(()=>t[13]||(t[13]=[u("新增")])),_:1}),l(d,{type:"danger",plain:"",onClick:T},{default:a(()=>t[14]||(t[14]=[u("批量删除")])),_:1})]),g("div",be,[l(J,{stripe:"",data:e.tableData,border:"",onSelectionChange:q},{default:a(()=>[l(i,{type:"selection",width:"55","header-align":"center",align:"center"}),l(i,{prop:"categoryName",label:"分类名称"}),l(i,{prop:"name",label:"菜品名称"}),l(i,{prop:"content",label:"菜品描述","show-overflow-tooltip":""}),l(i,{prop:"img",label:"菜品封面"},{default:a(o=>[l(A,{src:o.row.img,"preview-src-list":[o.row.img],fit:"cover",style:{width:"50px",height:"50px","object-fit":"cover"},"preview-teleported":""},{error:a(()=>[g("div",Ve,[l($,null,{default:a(()=>[l(V(oe))]),_:1})])]),_:2},1032,["src","preview-src-list"])]),_:1}),l(i,{prop:"price",label:"价格"},{default:a(o=>[g("span",we," ￥"+w(o.row.price),1)]),_:1}),l(i,{prop:"num",label:"库存"},{default:a(o=>[g("span",he,w(o.row.num)+"份 ",1)]),_:1}),l(i,{prop:"sales",label:"销量"}),l(i,{prop:"status",label:"上餐状态"},{default:a(o=>[o.row.status==="上架"?(m(),b(x,{key:0,type:"success"},{default:a(()=>[u(w(o.row.status),1)]),_:2},1024)):h("",!0),o.row.status==="下架"?(m(),b(x,{key:1,type:"danger"},{default:a(()=>[u(w(o.row.status),1)]),_:2},1024)):h("",!0)]),_:1}),l(i,{label:"操作",width:"180"},{default:a(o=>[l(d,{type:"primary",circle:"",icon:V(ae),onClick:K=>B(o.row)},null,8,["icon","onClick"]),l(d,{type:"danger",circle:"",icon:V(re),onClick:K=>R(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(m(),y("div",ve,[l(M,{onCurrentChange:p,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[2]||(t[2]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):h("",!0),l(H,{title:"菜品信息",modelValue:e.formVisible,"onUpdate:modelValue":t[10]||(t[10]=o=>e.formVisible=o),width:"30%"},{footer:a(()=>[g("div",ke,[l(d,{onClick:t[9]||(t[9]=o=>e.formVisible=!1)},{default:a(()=>t[16]||(t[16]=[u("取消")])),_:1}),l(d,{type:"primary",onClick:O},{default:a(()=>t[17]||(t[17]=[u(" 确定 ")])),_:1})])]),default:a(()=>[l(L,{ref_key:"formRef",ref:v,rules:e.rules,model:e.form,"label-width":"80px",style:{padding:"20px"}},{default:a(()=>[l(c,{prop:"name",label:"菜品名称"},{default:a(()=>[l(_,{modelValue:e.form.name,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.name=o),placeholder:"请输入菜品名称"},null,8,["modelValue"])]),_:1}),l(c,{prop:"categoryId",label:"菜品分类"},{default:a(()=>[l(k,{modelValue:e.form.categoryId,"onUpdate:modelValue":t[4]||(t[4]=o=>e.form.categoryId=o),placeholder:"请选择菜品分类",style:{width:"100%"}},{default:a(()=>[(m(!0),y(I,null,N(e.categoryData,o=>(m(),b(s,{key:o.id,label:o.title,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{prop:"content",label:"菜品描述"},{default:a(()=>[l(_,{type:"textarea",rows:5,modelValue:e.form.content,"onUpdate:modelValue":t[5]||(t[5]=o=>e.form.content=o),placeholder:"请输入菜品描述"},null,8,["modelValue"])]),_:1}),l(c,{prop:"price",label:"菜品价格"},{default:a(()=>[l(_,{modelValue:e.form.price,"onUpdate:modelValue":t[6]||(t[6]=o=>e.form.price=o),placeholder:"请输入菜品价格"},null,8,["modelValue"])]),_:1}),l(c,{prop:"num",label:"库存"},{default:a(()=>[l(_,{modelValue:e.form.num,"onUpdate:modelValue":t[7]||(t[7]=o=>e.form.num=o),placeholder:"请输入菜品库存"},null,8,["modelValue"])]),_:1}),l(c,{prop:"img",label:"菜品封面"},{default:a(()=>[l(j,{class:"upload-demo",action:V(S)+"/files/upload","on-success":F,"list-type":"picture","show-file-list":!1},{default:a(()=>[l(d,{type:"primary"},{default:a(()=>t[15]||(t[15]=[u("文件上传")])),_:1})]),_:1},8,["action"])]),_:1}),l(c,{prop:"status",label:"上餐状态"},{default:a(()=>[l(G,{modelValue:e.form.status,"onUpdate:modelValue":t[8]||(t[8]=o=>e.form.status=o)},{default:a(()=>[l(E,{label:"上架",value:"上架"}),l(E,{label:"下架",value:"下架"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{Me as default};
