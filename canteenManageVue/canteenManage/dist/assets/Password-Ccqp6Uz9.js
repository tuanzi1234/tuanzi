/* empty css                *//* empty css                  *//* empty css               *//* empty css              */import{r as _}from"./request-Deya0qTv.js";import{s as g,r as P,c as V,b as r,w as t,L as E,o as v,a as b,g as x,E as u,y,J as h,z as I}from"./index-BRfxGLPL.js";const B={style:{width:"50%"},class:"card"},N={style:{"text-align":"center"}},J={__name:"Password",setup(q){const n=g(),p=(l,e,o)=>{e?(e!==s.user.newPassword&&o(new Error("两次输入的密码不匹配，请重新输入")),o()):o(new Error("请输入密码"))},m=JSON.parse(localStorage.getItem("project-user")||"{}"),s=P({user:{password:"",newPassword:"",confirmPassword:""},rules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPassword:[{validator:p,trigger:"blur"}]}}),w=()=>{n.value.validate(l=>{if(l){const e={...m,password:s.user.password,newPassword:s.user.newPassword};_.put("/updatePassword",e).then(o=>{o.code==="200"?(u.success("更新成功"),i()):u.error(o.msg)})}else console.log("验证失败")})},i=()=>{localStorage.removeItem("project-user"),setInterval(()=>{location.href="/login"},500)};return(l,e)=>{const o=y,d=h,c=I,f=E;return v(),V("div",B,[r(f,{ref_key:"formRef",ref:n,rules:s.rules,model:s.user,"label-width":"70px",style:{padding:"20px"}},{default:t(()=>[r(d,{label:"原密码",prop:"password"},{default:t(()=>[r(o,{modelValue:s.user.password,"onUpdate:modelValue":e[0]||(e[0]=a=>s.user.password=a),placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),r(d,{label:"新密码",prop:"newPassword"},{default:t(()=>[r(o,{modelValue:s.user.newPassword,"onUpdate:modelValue":e[1]||(e[1]=a=>s.user.newPassword=a),placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(d,{label:"新密码",prop:"confirmPassword"},{default:t(()=>[r(o,{modelValue:s.user.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>s.user.confirmPassword=a),placeholder:"再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),b("div",N,[r(c,{type:"primary",onClick:w},{default:t(()=>e[3]||(e[3]=[x("保存")])),_:1})])]),_:1},8,["rules","model"])])}}};export{J as default};
