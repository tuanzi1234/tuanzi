/* empty css                *//* empty css                  *//* empty css               *//* empty css              */import{r as g}from"./request-B1eisu_F.js";import{s as _,r as P,c as V,b as o,w as t,L as b,o as E,a as v,g as x,E as u,y,J as h,z as I}from"./index-BMVJ4Z_q.js";const B={style:{width:"50%"},class:"card"},N={style:{"text-align":"center"}},J={__name:"Password",setup(q){const n=_(),m=(l,e,r)=>{e?(e!==s.user.newPassword&&r(new Error("两次输入的密码不匹配，请重新输入")),r()):r(new Error("请输入密码"))},p=JSON.parse(localStorage.getItem("project-user")||"{}"),s=P({user:{password:"",newPassword:"",confirmPassword:""},rules:{password:[{required:!0,message:"请输入原密码",trigger:"blur"},{min:6,message:"密码不能少于六位",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码不能少于六位",trigger:"blur"}],confirmPassword:[{validator:m,trigger:"blur"}]}}),i=()=>{n.value.validate(l=>{if(l){const e={...p,password:s.user.password,newPassword:s.user.newPassword};g.put("/updatePassword",e).then(r=>{r.code==="200"?(u.success("更新成功"),w()):u.error(r.msg)})}else console.log("验证失败")})},w=()=>{localStorage.removeItem("project-user"),setInterval(()=>{location.href="/login"},500)};return(l,e)=>{const r=y,d=h,c=I,f=b;return E(),V("div",B,[o(f,{ref_key:"formRef",ref:n,rules:s.rules,model:s.user,"label-width":"70px",style:{padding:"20px"}},{default:t(()=>[o(d,{label:"原密码",prop:"password"},{default:t(()=>[o(r,{modelValue:s.user.password,"onUpdate:modelValue":e[0]||(e[0]=a=>s.user.password=a),placeholder:"请输入原密码","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码",prop:"newPassword"},{default:t(()=>[o(r,{modelValue:s.user.newPassword,"onUpdate:modelValue":e[1]||(e[1]=a=>s.user.newPassword=a),placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),o(d,{label:"新密码",prop:"confirmPassword"},{default:t(()=>[o(r,{modelValue:s.user.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>s.user.confirmPassword=a),placeholder:"再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),v("div",N,[o(c,{type:"primary",onClick:i},{default:t(()=>e[3]||(e[3]=[x("保存")])),_:1})])]),_:1},8,["rules","model"])])}}};export{J as default};
