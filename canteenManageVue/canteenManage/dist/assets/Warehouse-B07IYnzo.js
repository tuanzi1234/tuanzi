/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css            *//* empty css               *//* empty css                  *//* empty css                   *//* empty css                    *//* empty css                *//* empty css               *//* empty css              */import{r as f}from"./request-B1eisu_F.js";import{r as O,s as R,c as h,a as p,b as l,w as a,v as b,E as s,x as v,y as A,z as I,A as G,B as H,C as L,o as c,g as i,t as g,P as w,u as C,F as Q,G as W,H as j,R as K,J as X,Q as Y,M as Z,L as ee}from"./index-BMVJ4Z_q.js";const te={class:"card"},le={class:"card",style:{"margin-bottom":"10px"}},oe={class:"card",style:{"margin-bottom":"10px"}},ae={style:{color:"red"}},re={style:{color:"green"}},ne={key:0,class:"card"},se={class:"dialog-footer"},ve={__name:"Warehouse",setup(ie){const e=O({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:5,total:0,name:null,ids:[],rules:{name:[{required:!0,message:"请输入名字",trigger:"blur"}],price:[{required:!0,message:"请输入市场价",trigger:"blur"}],num:[{required:!0,message:"请输入库存",trigger:"blur"}],status:[{required:!0,message:"请输入状态",trigger:"blur"}]}}),k=R(),E=()=>{e.form={},e.formVisible=!0},x=()=>{f.post("/warehouse/add",e.form).then(r=>{r.code==="200"?(s.success("添加成功"),d(),e.formVisible=!1):s.error(r.msg)})},N=r=>{e.form=JSON.parse(JSON.stringify(r)),e.formVisible=!0},S=r=>{e.ids=r.map(t=>t.id)},d=()=>{f.get("/warehouse/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(r=>{var t,n;r.code==="200"?(e.tableData=((t=r.data)==null?void 0:t.list)||[],e.total=(n=r.data)==null?void 0:n.total):s.error(r.msg)})};d();const z=()=>{f.put("/warehouse/update",e.form).then(r=>{r.code==="200"?(s.success("更新成功"),d(),e.formVisible=!1):s.error(r.msg)})},B=r=>{v.confirm("是否删除该系统库存信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(t=>{f.delete(`/warehouse/delete/${r.id}`).then(n=>{n.code==="200"?(s.success("删除成功"),d()):s.error(n.msg)}).catch(n=>{s.error(n)})})},U=()=>{if(!e.ids.length){s.warning("请选择要删除的系统库存信息");return}v.confirm("是否删除该系统库存信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(r=>{f.delete("/warehouse/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(s.success("删除成功"),d()):s.error(t.msg)}).catch(t=>{s.error(t)})})},q=()=>{k.value.validate(r=>{r&&(e.form.id?z():x())})},D=()=>{e.name=null,d()};return(r,t)=>{const n=A,u=I,m=j,y=K,P=G,T=H,_=X,V=Y,$=Z,F=ee,J=L;return c(),h("div",null,[p("div",te,[l(n,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.name=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入名字"},null,8,["modelValue"]),l(u,{type:"info",plain:"",onClick:d},{default:a(()=>t[8]||(t[8]=[i("查询")])),_:1}),l(u,{type:"info",style:{margin:"0 10px"},plain:"",onClick:D},{default:a(()=>t[9]||(t[9]=[i("重置")])),_:1})]),p("div",le,[l(u,{type:"primary",plain:"",onClick:E},{default:a(()=>t[10]||(t[10]=[i("新增")])),_:1}),l(u,{type:"danger",plain:"",onClick:U},{default:a(()=>t[11]||(t[11]=[i("批量删除")])),_:1})]),p("div",oe,[l(P,{stripe:"",data:e.tableData,border:"",style:{width:"100%"},onSelectionChange:S},{default:a(()=>[l(m,{type:"selection",width:"55","header-align":"center",align:"center"}),l(m,{prop:"name",label:"名字"}),l(m,{prop:"price",label:"市场价"},{default:a(o=>[p("span",ae,"￥ "+g(o.row.price)+" / 千克",1)]),_:1}),l(m,{prop:"num",label:"库存"},{default:a(o=>[p("span",re,g(o.row.num)+" 千克",1)]),_:1}),l(m,{prop:"status",label:"状态"},{default:a(o=>[o.row.status==="正常"?(c(),w(y,{key:0,type:"success"},{default:a(()=>[i(g(o.row.status),1)]),_:2},1024)):b("",!0),o.row.status==="缺货"?(c(),w(y,{key:1,type:"danger"},{default:a(()=>[i(g(o.row.status),1)]),_:2},1024)):b("",!0),o.row.status==="过剩"?(c(),w(y,{key:2,type:"warning"},{default:a(()=>[i(g(o.row.status),1)]),_:2},1024)):b("",!0)]),_:1}),l(m,{prop:"time",label:"购入时间"}),l(m,{label:"操作",width:"180"},{default:a(o=>[l(u,{type:"primary",circle:"",icon:C(Q),onClick:M=>N(o.row)},null,8,["icon","onClick"]),l(u,{type:"danger",circle:"",icon:C(W),onClick:M=>B(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(c(),h("div",ne,[l(T,{onCurrentChange:d,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):b("",!0),l(J,{title:"库存信息",modelValue:e.formVisible,"onUpdate:modelValue":t[7]||(t[7]=o=>e.formVisible=o),width:"30%"},{footer:a(()=>[p("div",se,[l(u,{onClick:t[6]||(t[6]=o=>e.formVisible=!1)},{default:a(()=>t[12]||(t[12]=[i("取消")])),_:1}),l(u,{type:"primary",onClick:q},{default:a(()=>t[13]||(t[13]=[i(" 确定 ")])),_:1})])]),default:a(()=>[l(F,{ref_key:"formRef",ref:k,rules:e.rules,model:e.form,"label-width":"80px",style:{padding:"20px"}},{default:a(()=>[l(_,{prop:"name",label:"库存标题"},{default:a(()=>[l(n,{modelValue:e.form.name,"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.name=o),placeholder:"请输入名字"},null,8,["modelValue"])]),_:1}),l(_,{prop:"price",label:"市场价"},{default:a(()=>[l(n,{modelValue:e.form.price,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.price=o),placeholder:"请输入市场价"},null,8,["modelValue"])]),_:1}),l(_,{prop:"num",label:"库存"},{default:a(()=>[l(n,{modelValue:e.form.num,"onUpdate:modelValue":t[4]||(t[4]=o=>e.form.num=o),placeholder:"请输入库存"},null,8,["modelValue"])]),_:1}),l(_,{prop:"status",label:"状态"},{default:a(()=>[l($,{size:"large",modelValue:e.form.status,"onUpdate:modelValue":t[5]||(t[5]=o=>e.form.status=o)},{default:a(()=>[l(V,{label:"正常",value:"正常"}),l(V,{label:"缺货",value:"缺货"}),l(V,{label:"过剩",value:"过剩"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ve as default};
