/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as f}from"./request-B1eisu_F.js";import{r as P,s as T,c as b,a as c,b as l,w as r,v as j,E as s,x as V,y as M,z as O,A as R,B as G,C as H,o as y,g as p,u as g,D as K,F as L,G as Q,H as W,k as X,I as Y,J as Z,K as ee,L as te}from"./index-BMVJ4Z_q.js";const le={class:"card"},ae={class:"card",style:{"margin-bottom":"10px"}},oe={class:"card",style:{"margin-bottom":"10px"}},re={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},ne={key:0,class:"card"},se={class:"dialog-footer"},ke={__name:"Student",setup(ie){const v="http://localhost:9090",e=P({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:5,total:0,name:null,username:null,ids:[],editingId:null,rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{validator:(a,t,n)=>{t===""?n(new Error("请输入账号")):e.tableData.some(i=>i.username===t&&i.id!==e.editingId)?n(new Error("该账号已存在，请重新输入")):n()},trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}]}}),_=T(),h=()=>{e.form={},e.editingId=null,e.formVisible=!0},w=()=>{f.post("/student/add",e.form).then(a=>{a.code==="200"?(s.success("添加成功"),m(),e.formVisible=!1):s.error(a.msg)})},x=a=>{e.form=JSON.parse(JSON.stringify(a)),e.editingId=a.id,e.formVisible=!0},C=a=>{e.ids=a.map(t=>t.id)},m=()=>{f.get("/student/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,username:e.username}}).then(a=>{var t,n;a.code==="200"?(e.tableData=((t=a.data)==null?void 0:t.list)||[],e.total=(n=a.data)==null?void 0:n.total):s.error(a.msg)})};m();const E=()=>{f.put("/student/update",e.form).then(a=>{a.code==="200"?(s.success("更新成功"),m(),e.formVisible=!1):s.error(a.msg)})},k=a=>{V.confirm("是否删除该用户信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(t=>{f.delete(`/student/delete/${a.id}`).then(n=>{n.code==="200"?(s.success("删除成功"),m()):s.error(n.msg)}).catch(n=>{s.error(n)})})},S=()=>{if(!e.ids.length){s.warning("请选择要删除的用户信息");return}V.confirm("是否删除该用户信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(a=>{f.delete("/student/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(s.success("删除成功"),m()):s.error(t.msg)}).catch(t=>{s.error(t)})})},U=()=>{_.value.validate(a=>{a&&(e.form.id?E():w())})},N=a=>{e.form.avatar=a.data,s.success("文件上传成功，点击“确定”即可查看")},I=()=>{e.username=null,e.name=null,m()};return(a,t)=>{const n=M,d=O,i=W,D=X,z=Y,B=R,$=G,u=Z,q=ee,A=te,F=H;return y(),b("div",null,[c("div",le,[l(n,{modelValue:e.username,"onUpdate:modelValue":t[0]||(t[0]=o=>e.username=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入账号查询"},null,8,["modelValue"]),l(n,{modelValue:e.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.name=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入名称查询"},null,8,["modelValue"]),l(d,{type:"info",plain:"",onClick:m},{default:r(()=>t[9]||(t[9]=[p("查询")])),_:1}),l(d,{type:"info",style:{margin:"0 10px"},plain:"",onClick:I},{default:r(()=>t[10]||(t[10]=[p("重置")])),_:1})]),c("div",ae,[l(d,{type:"primary",plain:"",onClick:h},{default:r(()=>t[11]||(t[11]=[p("新增")])),_:1}),l(d,{type:"danger",plain:"",onClick:S},{default:r(()=>t[12]||(t[12]=[p("批量删除")])),_:1})]),c("div",oe,[l(B,{stripe:"",data:e.tableData,border:"",style:{width:"100%"},onSelectionChange:C},{default:r(()=>[l(i,{type:"selection",width:"55","header-align":"center",align:"center"}),l(i,{prop:"username",label:"账号"}),l(i,{prop:"avatar",label:"头像"},{default:r(o=>[l(z,{src:o.row.avatar,"preview-src-list":[o.row.avatar],fit:"cover",style:{width:"50px",height:"50px","object-fit":"cover"},"preview-teleported":""},{error:r(()=>[c("div",re,[l(D,null,{default:r(()=>[l(g(K))]),_:1})])]),_:2},1032,["src","preview-src-list"])]),_:1}),l(i,{prop:"name",label:"姓名"}),l(i,{prop:"role",label:"角色"}),l(i,{prop:"phone",label:"电话"}),l(i,{prop:"email",label:"邮箱"}),l(i,{label:"操作",width:"180"},{default:r(o=>[l(d,{type:"primary",circle:"",icon:g(L),onClick:J=>x(o.row)},null,8,["icon","onClick"]),l(d,{type:"danger",circle:"",icon:g(Q),onClick:J=>k(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(y(),b("div",ne,[l($,{onCurrentChange:m,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[2]||(t[2]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):j("",!0),l(F,{title:"用户信息",modelValue:e.formVisible,"onUpdate:modelValue":t[8]||(t[8]=o=>e.formVisible=o),width:"30%"},{footer:r(()=>[c("div",se,[l(d,{onClick:t[7]||(t[7]=o=>e.formVisible=!1)},{default:r(()=>t[14]||(t[14]=[p("取消")])),_:1}),l(d,{type:"primary",onClick:U},{default:r(()=>t[15]||(t[15]=[p(" 确定 ")])),_:1})])]),default:r(()=>[l(A,{ref_key:"formRef",ref:_,rules:e.rules,model:e.form,"label-width":"80px",style:{padding:"20px"}},{default:r(()=>[l(u,{prop:"username",label:"用户账号"},{default:r(()=>[l(n,{modelValue:e.form.username,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.username=o),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(u,{prop:"avatar",label:"头像"},{default:r(()=>[l(q,{class:"upload-demo",action:g(v)+"/files/upload","show-file-list":!1,"on-success":N,"list-type":"picture"},{default:r(()=>[l(d,{type:"primary"},{default:r(()=>t[13]||(t[13]=[p("文件上传")])),_:1})]),_:1},8,["action"])]),_:1}),l(u,{prop:"name",label:"姓名"},{default:r(()=>[l(n,{modelValue:e.form.name,"onUpdate:modelValue":t[4]||(t[4]=o=>e.form.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),l(u,{prop:"phone",label:"电话"},{default:r(()=>[l(n,{modelValue:e.form.phone,"onUpdate:modelValue":t[5]||(t[5]=o=>e.form.phone=o),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1}),l(u,{prop:"email",label:"邮箱"},{default:r(()=>[l(n,{modelValue:e.form.email,"onUpdate:modelValue":t[6]||(t[6]=o=>e.form.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ke as default};
