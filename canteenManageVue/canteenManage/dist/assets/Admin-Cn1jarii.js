/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                    *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as f}from"./request-6eHoymb-.js";import{r as P,s as T,c as b,a as c,b as t,w as r,v as j,E as i,x as V,y as M,z as O,A as R,B as G,C as H,o as y,g as p,u as g,D as K,F as L,G as Q,H as W,k as X,I as Y,J as Z,K as ee,L as le}from"./index-C86Pu7Zh.js";const te={class:"card"},ae={class:"card",style:{"margin-bottom":"10px"}},oe={class:"card",style:{"margin-bottom":"10px"}},re={style:{display:"flex","justify-content":"center","align-items":"center",width:"100%",height:"100%"}},ne={key:0,class:"card"},ie={class:"dialog-footer"},ke={__name:"Admin",setup(se){const v="http://localhost:9090",e=P({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:5,total:0,name:null,username:null,ids:[],editingId:null,rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{validator:(a,l,n)=>{l===""?n(new Error("请输入账号")):e.tableData.some(s=>s.username===l&&s.id!==e.editingId)?n(new Error("该账号已存在，请重新输入")):n()},trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码格式",trigger:"blur"}]}}),_=T(),h=()=>{e.form={},e.editingId=null,e.formVisible=!0},w=()=>{f.post("/admin/add",e.form).then(a=>{a.code==="200"?(i.success("添加成功"),m(),e.formVisible=!1):i.error(a.msg)})},x=a=>{e.form=JSON.parse(JSON.stringify(a)),e.editingId=a.id,e.formVisible=!0},C=a=>{e.ids=a.map(l=>l.id)},m=()=>{f.get("/admin/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name,username:e.username}}).then(a=>{var l,n;a.code==="200"?(e.tableData=((l=a.data)==null?void 0:l.list)||[],e.total=(n=a.data)==null?void 0:n.total):i.error(a.msg)})};m();const E=()=>{f.put("/admin/update",e.form).then(a=>{a.code==="200"?(i.success("更新成功"),m(),e.formVisible=!1):i.error(a.msg)})},k=a=>{V.confirm("是否删除该管理员信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(l=>{f.delete(`/admin/delete/${a.id}`).then(n=>{n.code==="200"?(i.success("删除成功"),m()):i.error(n.msg)}).catch(n=>{i.error(n)})})},U=()=>{if(!e.ids.length){i.warning("请选择要删除的管理员信息");return}V.confirm("是否删除该管理员信息?（删除后将无法恢复）","删除确认",{type:"warning"}).then(a=>{f.delete("/admin/delete/batch",{data:e.ids}).then(l=>{l.code==="200"?(i.success("删除成功"),m()):i.error(l.msg)}).catch(l=>{i.error(l)})})},N=()=>{_.value.validate(a=>{a&&(e.form.id?E():w())})},S=a=>{e.form.avatar=a.data,i.success("文件上传成功，点击“确定”即可查看")},I=()=>{e.username=null,e.name=null,m()};return(a,l)=>{const n=M,d=O,s=W,D=X,z=Y,B=R,$=G,u=Z,q=ee,A=le,F=H;return y(),b("div",null,[c("div",te,[t(n,{modelValue:e.username,"onUpdate:modelValue":l[0]||(l[0]=o=>e.username=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入账号查询"},null,8,["modelValue"]),t(n,{modelValue:e.name,"onUpdate:modelValue":l[1]||(l[1]=o=>e.name=o),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入名称查询"},null,8,["modelValue"]),t(d,{type:"info",plain:"",onClick:m},{default:r(()=>l[9]||(l[9]=[p("查询")])),_:1}),t(d,{type:"info",style:{margin:"0 10px"},plain:"",onClick:I},{default:r(()=>l[10]||(l[10]=[p("重置")])),_:1})]),c("div",ae,[t(d,{type:"primary",plain:"",onClick:h},{default:r(()=>l[11]||(l[11]=[p("新增")])),_:1}),t(d,{type:"danger",plain:"",onClick:U},{default:r(()=>l[12]||(l[12]=[p("批量删除")])),_:1})]),c("div",oe,[t(B,{stripe:"",data:e.tableData,border:"",style:{width:"100%"},onSelectionChange:C},{default:r(()=>[t(s,{type:"selection",width:"55","header-align":"center",align:"center"}),t(s,{prop:"username",label:"账号"}),t(s,{prop:"avatar",label:"头像"},{default:r(o=>[t(z,{src:o.row.avatar,"preview-src-list":[o.row.avatar],fit:"cover",style:{width:"50px",height:"50px","object-fit":"cover"},"preview-teleported":""},{error:r(()=>[c("div",re,[t(D,null,{default:r(()=>[t(g(K))]),_:1})])]),_:2},1032,["src","preview-src-list"])]),_:1}),t(s,{prop:"name",label:"姓名"}),t(s,{prop:"role",label:"角色"}),t(s,{prop:"phone",label:"电话"}),t(s,{prop:"email",label:"邮箱"}),t(s,{label:"操作",width:"180"},{default:r(o=>[t(d,{type:"primary",circle:"",icon:g(L),onClick:J=>x(o.row)},null,8,["icon","onClick"]),t(d,{type:"danger",circle:"",icon:g(Q),onClick:J=>k(o.row)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(y(),b("div",ne,[t($,{onCurrentChange:m,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":l[2]||(l[2]=o=>e.pageNum=o),total:e.total},null,8,["page-size","current-page","total"])])):j("",!0),t(F,{title:"管理员信息",modelValue:e.formVisible,"onUpdate:modelValue":l[8]||(l[8]=o=>e.formVisible=o),width:"30%"},{footer:r(()=>[c("div",ie,[t(d,{onClick:l[7]||(l[7]=o=>e.formVisible=!1)},{default:r(()=>l[14]||(l[14]=[p("取消")])),_:1}),t(d,{type:"primary",onClick:N},{default:r(()=>l[15]||(l[15]=[p(" 确定 ")])),_:1})])]),default:r(()=>[t(A,{ref_key:"formRef",ref:_,rules:e.rules,model:e.form,"label-width":"80px",style:{padding:"20px"}},{default:r(()=>[t(u,{prop:"username",label:"用户账号"},{default:r(()=>[t(n,{modelValue:e.form.username,"onUpdate:modelValue":l[3]||(l[3]=o=>e.form.username=o),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),t(u,{prop:"avatar",label:"头像"},{default:r(()=>[t(q,{class:"upload-demo",action:g(v)+"/files/upload","on-success":S,"list-type":"picture","show-file-list":!1},{default:r(()=>[t(d,{type:"primary"},{default:r(()=>l[13]||(l[13]=[p("文件上传")])),_:1})]),_:1},8,["action"])]),_:1}),t(u,{prop:"name",label:"姓名"},{default:r(()=>[t(n,{modelValue:e.form.name,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),t(u,{prop:"phone",label:"电话"},{default:r(()=>[t(n,{modelValue:e.form.phone,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.phone=o),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1}),t(u,{prop:"email",label:"邮箱"},{default:r(()=>[t(n,{modelValue:e.form.email,"onUpdate:modelValue":l[6]||(l[6]=o=>e.form.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ke as default};
